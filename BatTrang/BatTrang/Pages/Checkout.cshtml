@page
@model BatTrang.Pages.CheckoutModel
@{
    ViewData["Title"] = "Thanh toán";
}
@Html.AntiForgeryToken()

<div class="container py-4">
    <h2 class="mb-3">Thông tin thanh toán</h2>
    <form method="post">
        <div class="row">
            <div class="col-lg-8">
                <div class="card mb-3">
                    <div class="card-header">Thông tin nhận hàng</div>
                    <div class="card-body row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Họ tên</label>
                            <input asp-for="Input.FullName" class="form-control" required />
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Số điện thoại</label>
                            <input asp-for="Input.Phone" class="form-control" required />
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Email</label>
                            <input asp-for="Input.Email" type="email" class="form-control" />
                        </div>
                        <div class="col-12">
                            <label class="form-label">Địa chỉ</label>
                            <input asp-for="Input.Address" class="form-control" required />
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Phường/Xã</label>
                            <input asp-for="Input.Ward" class="form-control" />
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Quận/Huyện</label>
                            <input asp-for="Input.District" class="form-control" />
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Tỉnh/TP</label>
                            <input asp-for="Input.Province" class="form-control" />
                        </div>
                        <div class="col-12">
                            <label class="form-label">Ghi chú</label>
                            <textarea asp-for="Input.Note" class="form-control"></textarea>
                        </div>
                    </div>
                </div>

                <div class="card mb-3">
                    <div class="card-header">Phương thức thanh toán</div>
                    <div class="card-body">
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" asp-for="Input.PaymentMethod" value="COD" checked id="pmCOD" />
                            <label class="form-check-label" for="pmCOD">Thanh toán khi nhận hàng (COD)</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" asp-for="Input.PaymentMethod" value="DIRECT" id="pmDIRECT" />
                            <label class="form-check-label" for="pmDIRECT">Thanh toán trực tiếp (tại cửa hàng hoặc chuyển khoản)</label>
                        </div>

                        <div id="directInfo" class="alert alert-info mt-3 d-none">
                            <h6 class="mb-2">Hướng dẫn thanh toán trực tiếp</h6>
                            <ul class="mb-2">
                                <li>Trả tiền tại cửa hàng khi đến nhận.</li>
                                <li>Hoặc chuyển khoản: <strong>Ngân hàng ABC - STK 123456789 - Chủ TK: Công ty Gốm Bát Tràng</strong>.</li>
                            </ul>
                            <small>Sau khi chuyển khoản, vui lòng giữ lại chứng từ. Đơn sẽ được xác nhận khi shop kiểm tra xong.</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header">Đơn hàng</div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between"><span>Tạm tính</span><strong>@Model.Summary.Subtotal.ToString("C0")</strong></div>
                        <div class="d-flex justify-content-between"><span>Phí vận chuyển</span><strong>@Model.Summary.ShippingFee.ToString("C0")</strong></div>
                        <div class="d-flex justify-content-between mb-2"><span>Giảm giá</span><strong>-@Model.Summary.Discount.ToString("C0")</strong></div>
                        <hr />
                        <div class="d-flex justify-content-between"><span>Tổng cộng</span><strong class="text-success">@Model.Summary.Total.ToString("C0")</strong></div>
                        <button type="submit" class="btn btn-success w-100 mt-3">Đặt hàng</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <script>
        function toggleDirectInfo(){
          const direct = document.getElementById('pmDIRECT').checked;
          document.getElementById('directInfo').classList.toggle('d-none', !direct);
        }
        document.getElementById('pmDIRECT').addEventListener('change', toggleDirectInfo);
        document.getElementById('pmCOD').addEventListener('change', toggleDirectInfo);
        toggleDirectInfo();
    </script>
}
